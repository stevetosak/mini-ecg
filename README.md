# MINI ECG

## Преглед

Овој проект користи **AD8232 ECG модул**, **ESP32-WROOM-32D микроконтролер** и **SSD1306 OLED дисплеј** за да се снима и визуализира електрокардиограм (ECG) во реално време. Проектот исто така го пресметува **пулсот (BPM)** со детектирање на R-пикови во ECG сигналот.

Проектот е едноставна имплементација на преносен ECG монитор.

---

## Како работи ECG

Електрокардиограм (ECG) ја мери електричната активност на срцето.

* Срцето генерира електрични импулси при секоја контракциja (систола)
* Сигналот од срцето се мери преку електроди поставени на телото.
* Главните компоненти на сигналот се:

  * **P бран**: мала позитивна промена пред QRS комплексот
  * **QRS комплекс**: највисокиот пик, одговара на контракцијата на коморите
  * **T бран**: мала позитивна промена по QRS комплексот

Овие пикови овозможуваат пресметка на срцевата фреквенција и анализа на срцевиот ритам.

---

## Како работи AD8232 модулот

**AD8232** е специјализиран предзасилувач за биосигнали:

1. **Влезни електроди (RA, LA, RL)**:

   * RA и LA ја мерат разликата во потенцијалите на десната и левата рака.
   * RL е референца за стабилизација и отстранување на шум.

2. **Засилување на сигналот:**

   * ECG сигналите се многу мали (микроволти), па AD8232 го засилува сигналот до вредности кои ESP32 може да ги чита.
   * Исто така има вграден филтер за отстранување на 50/60Hz бучава и други електромагнетни шумови.

3. **Analog output (OUT)**

   * На OUT пинот се добива засилениот и филтрираниот ECG сигнал.
   * ESP32 го чита овој сигнал преку ADC за да го прикаже и обработи.

---

## Компоненти и нивни улоги

| Компонента             | Улога                                                         |
| ---------------------- | ------------------------------------------------------------- |
| ESP32-WROOM-32D        | Главен контролер, чита ADC, пресметува BPM и управува со OLED |
| AD8232 ECG Module      | Засилува и филтрира биосигнал (еднолиден ECG)                 |
| Електроди (RA, LA, RL) | RA и LA го снимаат сигналот, RL го стабилизира                |
| SSD1306 OLED           | Прикажува ECG бран и BPM                                      |

---

## Поставување на хардверот

| AD8232 Pin | ESP32 Pin    | Напомена                      |
| ---------- | ------------ | ----------------------------- |
| OUTPUT     | GPIO34 (ADC) | ECG сигнал за читање          |
| GND        | GND          | Заедничка земја               |
| 3.3V       | 3.3V         | Напојување                    |
| RA         | RA електрод  | Влез за десна рака            |
| LA         | LA електрод  | Влез за лева рака             |
| RL         | RL електрод  | Референца / намалување на шум |

OLED (I2C):

* SDA → GPIO21
* SCL → GPIO22
* VCC → 3.3V
* GND → GND

---

## Како работи проектот

1. **Снимање на сигналот:**

   * Електродите детектираат мали промени во потенцијалот од срцето.
   * AD8232 го засилува и филтрира сигналот.

2. **Читање преку ESP32:**

   * ESP32 чита аналоген сигнал преку GPIO34.
   * Секој примерок се мапира на висина на OLED дисплејот.

3. **Бафер и прикажување:**

   * Еден **кружен бафер** ги чува последните 128 примероци (\~1.3 секунди при 100Hz).
   * На OLED се прикажуваат последните 128 примероци како линеарен график.

4. **Детекција на срцеви удари (R-пикови):**

   * Секој сигнал кој ја надминува поставената граница (threshold) се смета за R-пик.
   * Времето помеѓу два R-пикови (R-R интервал) се користи за пресметка на **BPM**:

     ```
     BPM = 60000 / RR_interval(ms)
     ```

5. **Прикажување на OLED:**

   * Прикажува линеарен ECG график
   * Прикажува тековен BPM

---

## Ограничувања и можни подобрувања

* Поддржува **само една lead (Lead I)**, што значи дека нема целосна точност како 12-lead
* Квалитетот на сигналот зависи од поставување на електродите и шум.

---

## Литература

[AD8232 Документација](https://www.analog.com/media/en/technical-documentation/data-sheets/ad8232.pdf)


